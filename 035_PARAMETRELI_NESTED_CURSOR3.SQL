DECLARE
  CURSOR C_LOC
  IS
  SELECT LOCATION_ID, CITY
  FROM LOCATIONS
  ORDER BY CITY;

  R_LOC C_LOC%ROWTYPE;

  CURSOR C_DEPT(P_LOC_ID DEPARTMENTS.LOCATION_ID%TYPE)
  IS
  SELECT DEPARTMENT_ID, DEPARTMENT_NAME
  FROM DEPARTMENTS
  WHERE LOCATION_ID = P_LOC_ID
  ORDER BY DEPARTMENT_NAME;

  R_DEPT C_DEPT%ROWTYPE;

  CURSOR C_EMP(P_DEPT EMPLOYEES.DEPARTMENT_ID%TYPE)
  IS
  SELECT EMPLOYEE_ID, FIRST_NAME || ' - ' || LAST_NAME AS AD_SOYAD, HIRE_DATE, JOB_ID
  FROM EMPLOYEES
  WHERE DEPARTMENT_ID = P_DEPT
  ORDER BY EMPLOYEE_ID;

  R_EMP C_EMP%ROWTYPE;
BEGIN
  DBMS_OUTPUT.NEW_LINE;
  DBMS_OUTPUT.PUT_LINE(' ################## ');
  DBMS_OUTPUT.NEW_LINE;
  OPEN C_LOC;
  LOOP
    FETCH C_LOC
    INTO R_LOC;
    EXIT WHEN C_LOC%NOTFOUND;
    DBMS_OUTPUT.PUT_LINE(' | LOKASYON: ' || R_LOC.CITY || ' | LOKASYON ID: (' || R_LOC.LOCATION_ID || ')');
    OPEN C_DEPT(R_LOC.LOCATION_ID);
      LOOP
        FETCH C_DEPT
        INTO R_DEPT;
        EXIT WHEN C_DEPT%NOTFOUND;
        DBMS_OUTPUT.PUT_LINE(' |______> ' || R_DEPT.DEPARTMENT_NAME || '(' || R_DEPT.DEPARTMENT_ID || ')');
        OPEN C_EMP(R_DEPT.DEPARTMENT_ID);
        LOOP
          FETCH C_EMP
          INTO R_EMP;
          EXIT WHEN C_EMP%NOTFOUND;
          DBMS_OUTPUT.PUT_LINE('        |_______> ' || R_EMP.EMPLOYEE_ID || '(' || R_EMP.AD_SOYAD || ' | JOB_ID: ' || R_EMP.JOB_ID || ' | GIRIS TARIHI: ' || TO_CHAR(R_EMP.HIRE_DATE, 'DD/MM/YYYY') || ')');
        END LOOP;
        CLOSE C_EMP;
      END LOOP;
    CLOSE C_DEPT;
  END LOOP;
  CLOSE C_LOC;
END;
