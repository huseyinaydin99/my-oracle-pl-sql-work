-- DATABASE ICINDELI BIR KULLANICI
-- DATABASE DISINDAKI BIR WEB ADRESINE
-- ERISMEYE CALISIYOR ANCAK DISA ERISIM
-- YETKISI BULUNMADIGI ICIN ACCESS CONTROL LIST
-- TARAFINDAN ENGELENIYOR. BU BIR GUVENLIK ONLEMI ASLINDA.

-- 1. ADIM
SELECT *
FROM DBA_NETWORK_ACLS; -- ACCESS CONTROL LIST'LERE BAKTIK.

BEGIN
    DBMS_NETWORK_ACL_ADMIN.CREATE_ACL(
        ACL => 'http_permission.xml',
        DESCRIPTION => 'HTTP Access / HTTP Erisim',
        PRINCIPAL => 'SYS',
        IS_GRANT => TRUE,
        PRIVILEGE => 'connect',
        START_DATE => NULL,
        END_DATE => NULL
    ); --ACL OLUSTURDUK.
END;

-- 2. ADIM
SELECT *
FROM DBA_NETWORK_ACL_PRIVILEGES
WHERE PRINCIPAL = 'SYS'; -- ACCESS CONTROL LIST YETKISI VAR MI?

BEGIN
    DBMS_NETWORK_ACL_ADMIN.ADD_PRIVILEGE(
        ACL => 'http_permission.xml',
        PRINCIPAL => 'SYS',
        IS_GRANT => TRUE,
        PRIVILEGE => 'connect'
    );
END; -- SYS KULLANICISINA ACCESS KONTROL LIST YETKISI VERDIK. ARTIK DISA ACILABILIR.

-- 3. ADIM ACL HEDEF ADRESE ATAMA
BEGIN
    DBMS_NETWORK_ACL_ADMIN.ASSIGN_ACL(
        ACL => 'http_permission.xml',
        host => 'www.tcmb.gov.tr',
        LOWER_PORT => 80,
        UPPER_PORT => 80
    );
END;

SHOW USER;