DESC DEPARTMENTS;

SELECT TO_CHAR(SYSDATE, 'DY')
FROM DUAL;

EXEC INS_DEPT(280, 'EGITIM', '145', 1700, );

DECLARE
  WSONUC VARCHAR2(300);
BEGIN
  --<< POZISYON NOTASYONU
  INS_DEPT(280, 'EGITIM', '145', 1700, WSONUC);
  --<< ISIN NOTASYONU
  INS_DEPT(P_DNO => 281, P_NAME => 'MUHASEBE', P_MAN => 145, P_SONUC => WSONUC);
  --<<
  INS_DEPT();
  PRINT(WSONUC);
END;

DROP
PROCEDURE INS_DEPT; 

CREATE OR REPLACE
PROCEDURE INS_DEPT(
  P_DNO    IN NUMBER,
  P_NAME   IN VARCHAR2,
  P_MAN    IN DEPARTMENTS.MANAGER_ID%TYPE DEFAULT 145,
  P_LOC    IN DEPARTMENTS.LOCATION_ID%TYPE,
  P_RESULT OUT NOCOPY VARCHAR2
  )
IS

BEGIN
  IF TO_CHAR(SYSDATE, 'DY') IN('CMT', 'PAZ', 'PZT')
  THEN
    P_RESULT := 'CUMARTESI VE PAZAR KAYIT GIRILEMEZ.';
  ELSE
    BEGIN
      INSERT
      INTO DEPARTMENTS(
        DEPARTMENT_ID,
        DEPARTMENT_NAME,
        MANAGER_ID,
        LOCATION_ID
      )
      VALUES(
        P_DNO,
        P_NAME,
        P_MAN,
        P_LOC
      );
      P_RESULT := 'KAYIT YAPILDI';
      EXCEPTION WHEN OTHERS THEN
        P_RESULT := SQLCODE || ' ' || SQLERRM;
    END;
  END IF;
END;
